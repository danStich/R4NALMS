<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Applications of R for Aquatic Plant Data</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<!DOCTYPE html>
<head>
<!-- Favicon for various operating systems -->
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="./favicon/favicon-16x16.png">
<!-- <link rel="manifest" href="./favicon/site.webmanifest"> -->
<link rel="mask-icon" href="./favicon/safari-pinned-tab.svg" color="#603cba">
<link rel="shortcut icon" href="./favicon/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="./favicon/browserconfig.xml">
<meta name="theme-color" content="#382121">
</head>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R4NALMS</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="software.html">Before the workshop</a>
</li>
<li>
  <a href="morning.html">Introduction to R</a>
</li>
<li>
  <a href="afternoon.html">Aquatic Plant Data in R</a>
</li>
<li>
  <a href="resources.html">Resources</a>
</li>
<li>
  <a href="instructors.html">Instructors</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.youtube.com/channel/UCcQsWXjTXYIfGTAJyxDaAyw/">
    <span class="fa fa-youtube"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/danStich/danStich.github.io/tree/master/r4nalms">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Applications of R for Aquatic Plant
Data</h1>

</div>


<p><img src="images/roh.png" alt=""></p>
<p>Welcome Applications of R for Aquatic Plant data! This module will
serve as a tutorial to help you understand how to improve your data and
analysis workflows for aquatic plant data in R. In this module, we will
read in and manipulate a standard data file format used for
point-intercept (rake-toss) surveys, we will demonstrate some basic
analyses for species richness and presence-absence data, and we will
cover some tools for visualizing results.</p>
<div id="libraries" class="section level2">
<h2>Libraries</h2>
<p>Let’s go ahead and load the libraries we’ll be working with in the
first half of this workshop.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>The first data set we’ll work with is from a point-intercept
(rake-toss) survey in Otsego Lake, NY, USA during summer 2025. Well…sort
of.</p>
<p>The original data were collected by Chii Kojima, an undergraduate at
Mt. Holyoke College and SUNY Oneonta BFS summer intern, and Mairi
Meehan, a professor at SUNY Cobleskill and BFS visiting faculty
researcher. They completed 3 surveys at 54 points throughout the growing
season on the dates included in the data set, with three rake tosses at
each site. They recorded <code>Depth</code>, location
(<code>Longitude</code> and <code>Latitude</code>), and categorical
abundance (<code>Z</code>, <code>T</code>, <code>S</code>,
<code>M</code>, or <code>D</code>) of each species at each site. If you
are not familiar with this categorical abundance scale, the letters
represent Zero, Trace, Sparse, Moderate, and Dense. They wanted to
understand seasonality in plant presence and abundance and whether this
and other factors could be used to improve survey design for long-term
monitoring.</p>
<p>We used the original data to simulate new data using an institutional
large language model (LLM, “AI”) to simulate new observations at sites
and dates from the survey based on spatial and temporal autocorrelation
in the data, with depth as a covariate of abundance, and with permission
for all of this from the data originators. As an aside, this was a fun
learning experience and the AI ended up using the same methods we would
have employed, but ironically it used Python instead of R. And, it did a
pretty not bad job of simulating the new data set that we’ll play with.
Back on track here.</p>
<p>Read in the simulated data now that we are done with story time:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>plants <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/plant_abundances.csv&quot;</span>)</span></code></pre></div>
<p>Have a look at the data set using <code>glimpse()</code>, as shown
below, or you can look at it in data table format using
<code>View()</code>. We’re not showing the output here in our version
because it’s a bit long.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">glimpse</span>(plants)</span></code></pre></div>
<p>This is a pretty standard point-intercept data set. It is in a
somewhat “wide” format. That is, plant species are in columns to the
right of all the other aggregated site and event data. The wide format
is good for data entry and viewing in spreadsheets, but it is not how
we’ll want the data formatted for <em>most</em> of our needs in R.</p>
<p>We’ll first need to get the data set into a longer format to work
with it more easily for most uses in R. This would be a bit of a
copy-paste nightmare in your typical spreadsheet application. But, it is
very easily done using the <code>pivot_longer()</code> function from the
<code>dplyr</code> package. We’re telling R to stack the individual
columns for species <code>8:ncol(plants)</code> into two columns: one
with species name, and one with categorical abundance. You would need to
change this for a different data set, but could also do things like
identify columns with underscore characters (<code>_</code>) if your
species columns were named similarly.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(plants,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                          <span class="at">cols =</span> <span class="dv">8</span><span class="sc">:</span><span class="fu">ncol</span>(plants),</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                          <span class="at">names_to =</span> <span class="st">&quot;Species&quot;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                          <span class="at">values_to =</span> <span class="st">&quot;Abundance&quot;</span>)</span></code></pre></div>
</div>
<div id="presence-absence-data" class="section level2">
<h2>Presence-absence data</h2>
<p>First, we’ll look at how we can work with information about presences
and absences of plants at each site on each survey to say something
about the plant community. Some common tools for assessing plant
communities might include metrics such as species richness or
evenness.</p>
<p>To start with, we’ll need to make a new column for presence-absence
data so we can do things like add up species. There are a few different
ways to do this. A succinct approach would be to initialize a new column
that is all zeroes and then replace any zeroes with ones if the
<code>Abundance</code> column contained anything other than
<code>Z</code>. Like this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Initialize new column called Presence of all `0`s</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>long_data<span class="sc">$</span>Presence <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># Change this to `1` if Abundance does not equal `Z` for zero</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>long_data<span class="sc">$</span>Presence[long_data<span class="sc">$</span>Abundance <span class="sc">!=</span> <span class="st">&quot;Z&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div>
<p>We could look at the presence absence data in a few different ways.
First, let’s estimate species richness for each <code>Site</code> and
<code>Survey</code> using the replicate observations
(<code>Toss</code>). We’re also keeping columns for
<code>Longitude</code> and <code>Latitude</code> here so we can play
with those below.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>richness <span class="ot">&lt;-</span> long_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">group_by</span>(Site, Survey, Longitude, Latitude) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Richness =</span> <span class="fu">sum</span>(Presence))</span></code></pre></div>
<p>Now we can make a boxplot to visualize richness across surveys (June,
July, August) to see if there are obvious seasonal trends.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(richness, <span class="fu">aes</span>(<span class="at">x =</span> Survey, <span class="at">y =</span> Richness, <span class="at">group =</span> Survey)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="aquatic-plants_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>This is cool, but you could spend some time to make it a little
prettier. It looks like there is an increase from June through the later
months, but it’s not super clear whether survey <code>2</code> and
<code>3</code> differed from one another.</p>
<p>You could formally test for differences among groups using a variety
of approaches.</p>
</div>
<div id="temporal-trends-in-species-richness" class="section level2">
<h2>Temporal trends in species richness</h2>
<p>The simplest approach, free of distributional assumptions and a lot
of other potential statistical pitfalls, would be to use a
non-parametric Kruskal-Wallis rank sum test to determine whether there
were significant differences in Richness among surveys.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">kruskal.test</span>(Richness <span class="sc">~</span> Survey, <span class="at">data =</span> richness)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    Kruskal<span class="sc">-</span>Wallis rank sum test</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>data<span class="sc">:</span>  Richness by Survey</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>Kruskal<span class="sc">-</span>Wallis chi<span class="sc">-</span>squared <span class="ot">=</span> <span class="fl">33.549</span>, df <span class="ot">=</span> <span class="dv">2</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">5.187e-08</span></span></code></pre></div>
<p>This tells us that there were differences among surveys, but it
doesn’t give us any statistical information about how richness differed
among sites. For that you’d need to use some kind of pairwise comparison
like the pairwise Wilcox test. Usually these tests have some kind of
adjustment to account for increased Type-I error rate. Here we use a
Bonferroni adjustment for p-values, although we are not advocating
specifically for that approach (there are a bunch).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(<span class="at">x =</span> richness<span class="sc">$</span>Richness, <span class="at">g =</span> richness<span class="sc">$</span>Survey, <span class="at">p.adjust.method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    Pairwise comparisons using Wilcoxon rank sum test with continuity correction </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>data<span class="sc">:</span>  richness<span class="sc">$</span>Richness and richness<span class="sc">$</span>Survey </span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="dv">1</span>       <span class="dv">2</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="dv">2</span> <span class="fl">8.6e-07</span> <span class="sc">-</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="dv">3</span> <span class="fl">3.2e-06</span> <span class="dv">1</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>P value adjustment method<span class="sc">:</span> bonferroni </span></code></pre></div>
<p>This output shows that richness differed significantly between
<code>Survey 1</code> and <code>Survey 2</code> (p &lt; 0.001), and
<code>Survey 1</code> and <code>Survey 3</code> (p &lt; 0.001), but we
failed to detect a difference in <code>Richness</code> between
<code>Survey 2</code> and <code>Survey 3</code> (p = 1). We could fall
back on the boxplot we made above to report these results.</p>
<p>At some point, you’d probably want to account for the fact that
species richness observations are based on multiple sites and locations,
either by incorporating that into statistical tests directly or as a
“random effect” in more complex models.</p>
</div>
<div id="spatial-trends-in-species-richness" class="section level2">
<h2>Spatial trends in species richness</h2>
<p>We could also use R to investigate spatial trends in species
richness. This requires a little more in-depth knowledge about
statistics and modeling, but it is still pretty straightforward to do in
R. This type of question is very approachable through use of generalized
linear models that include everything from ANOVA, linear regression, and
analysis of covariance (ANCOVA) to logistic regression and count models.
And, these modeling tools are easy to use in R (maybe too easy) as long
as you have a functional understanding of them.</p>
<p>For example, we could use the <code>glm()</code> function to examine
spatial and temporal patterns in species richness pretty easily. We use
a Poisson count model below to demonstrate what this could look
like.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>richness_mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(Richness <span class="sc">~</span> Longitude<span class="sc">*</span>Latitude <span class="sc">+</span> <span class="fu">factor</span>(Survey), </span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                    <span class="at">data =</span> richness, </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                    <span class="at">family =</span> poisson)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">summary</span>(richness_mod)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> Richness <span class="sc">~</span> Longitude <span class="sc">*</span> Latitude <span class="sc">+</span> <span class="fu">factor</span>(Survey), </span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    <span class="at">family =</span> poisson, <span class="at">data =</span> richness)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                     Estimate Std. Error z value <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span>)    </span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>(Intercept)        <span class="sc">-</span><span class="fl">1.844e+06</span>  <span class="fl">3.081e+05</span>  <span class="sc">-</span><span class="fl">5.985</span> <span class="fl">2.17e-09</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>Longitude          <span class="sc">-</span><span class="fl">2.462e+04</span>  <span class="fl">4.114e+03</span>  <span class="sc">-</span><span class="fl">5.984</span> <span class="fl">2.18e-09</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>Latitude            <span class="fl">4.309e+04</span>  <span class="fl">7.207e+03</span>   <span class="fl">5.979</span> <span class="fl">2.24e-09</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="fu">factor</span>(Survey)<span class="dv">2</span>     <span class="fl">6.620e-01</span>  <span class="fl">9.643e-02</span>   <span class="fl">6.865</span> <span class="fl">6.66e-12</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="fu">factor</span>(Survey)<span class="dv">3</span>     <span class="fl">6.714e-01</span>  <span class="fl">9.628e-02</span>   <span class="fl">6.974</span> <span class="fl">3.08e-12</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>Longitude<span class="sc">:</span>Latitude  <span class="fl">5.752e+02</span>  <span class="fl">9.621e+01</span>   <span class="fl">5.978</span> <span class="fl">2.25e-09</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">&#39;***&#39;</span> <span class="fl">0.001</span> <span class="st">&#39;**&#39;</span> <span class="fl">0.01</span> <span class="st">&#39;*&#39;</span> <span class="fl">0.05</span> <span class="st">&#39;.&#39;</span> <span class="fl">0.1</span> <span class="st">&#39; &#39;</span> <span class="dv">1</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>(Dispersion parameter <span class="cf">for</span> poisson family taken to be <span class="dv">1</span>)</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>    Null deviance<span class="sc">:</span> <span class="fl">340.47</span>  on <span class="dv">161</span>  degrees of freedom</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>Residual deviance<span class="sc">:</span> <span class="fl">207.62</span>  on <span class="dv">156</span>  degrees of freedom</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>AIC<span class="sc">:</span> <span class="fl">730.52</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>Number of Fisher Scoring iterations<span class="sc">:</span> <span class="dv">5</span></span></code></pre></div>
<p>We could check out the residuals to see whether we are in extreme
violation of distributional assumptions. These plots show that the model
residuals are more-or-less symmetrical, which aligns with assumptions of
the Poissson distribution. There are a few zeroes in the earliest survey
that are expressed as a peak around -1 for survey 1 in the plot below.
If this was a larger proportion we’d have to be careful about assessing
their influence, and may opt for an alternative approach, but this will
suffice for the rest of our example for now.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># You can extract model residuals (errors) like this</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># and add them to the original data</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>richness<span class="sc">$</span>residuals <span class="ot">&lt;-</span> richness_mod<span class="sc">$</span>residuals</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co"># That makes it easy to graph the residuals in ggplot!</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="fu">ggplot</span>(richness, <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Survey)</span></code></pre></div>
<p><img src="aquatic-plants_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Then, we could make predictions from the statistical model to
visualize the spatial and temporal patterns we found. Here, we’ll just
make predictions from the model on the response scale for simplicity (as
opposed to the link scale, but that’s a different workshop).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>richness<span class="sc">$</span>preds <span class="ot">&lt;-</span>  <span class="fu">predict</span>(richness_mod, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<p>Now, we can plot predicted species richness.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(richness, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">color =</span> preds)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Survey)</span></code></pre></div>
<p><img src="aquatic-plants_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Wow, that’s so cool!!! But, there are a bunch of things we can
improve, for example adding a color ramp that’s easier to read.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># We could use the RColorBrewer package to make a spectral scale that looks cool</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>myPalette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">10</span>, <span class="st">&quot;Spectral&quot;</span>)))</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">scale_colour_gradientn</span>(<span class="at">colours =</span> <span class="fu">myPalette</span>(<span class="dv">10</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                             <span class="at">oob =</span> scales<span class="sc">::</span>squish)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co"># Then we just add it to our ggplot like so, along with a couple of other </span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co"># changes in the name of beautiful data visualization</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="fu">ggplot</span>(richness, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">color =</span> preds)) <span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Survey) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  sc <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Species Richness&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="aquatic-plants_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="presence-absence-for-a-given-species" class="section level2">
<h2>Presence-absence for a given species</h2>
<p>We could use a similar approach to the one we used above to explore
trends in the presence of individual species as well. To do this, we
could work directly with the Presence column we created in
<code>long_data</code> during data manipulation.</p>
<p>Let’s filter the data set so that we are working with a single
species. You can choose a different one to work with, and none of the
code that follows should need to change, although your results will
likely differ dependent upon species.</p>
<p>The perceived expansion of clasping pondweed (<em>P.
richardsonii</em>) following dreissenid mussel invasions and increased
water clarity has been a common topic of discussion at basically any
gathering around Otsego Lake in recent years, so we’ll check that out
here.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>presence_data <span class="ot">&lt;-</span> long_data <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">&quot;Potamogeton_richardsonii&quot;</span>)</span></code></pre></div>
<p>Now, we can use the same <code>glm()</code> function that we used to
analyze species richness in the example above, but this time we’ll use a
“binomial” family for logistic regression. It really is that easy to use
in R.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>presence_mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(Presence <span class="sc">~</span> Longitude <span class="sc">*</span> Latitude <span class="sc">+</span> Survey,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>                    <span class="at">data =</span> presence_data,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                    <span class="at">family =</span> binomial)</span></code></pre></div>
<p>Just as before, we can make predictions from this model. In this
case, the response scale is probability of presence.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>presence_data<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(presence_mod, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) </span></code></pre></div>
<p>And, we can now plot probability of presence by site and survey!</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># We could use the RColorBrewer package to make a spectral scale that looks cool</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>myPalette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">10</span>, <span class="st">&quot;Spectral&quot;</span>)))</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">scale_colour_gradientn</span>(<span class="at">colours =</span> <span class="fu">myPalette</span>(<span class="dv">10</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>                             <span class="at">oob =</span> scales<span class="sc">::</span>squish)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co"># Then we just add it to our ggplot like so, along with a couple of other </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co"># changes in the name of beautiful data visualization</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="fu">ggplot</span>(presence_data, <span class="fu">aes</span>(<span class="at">x =</span> Longitude, <span class="at">y =</span> Latitude, <span class="at">color =</span> fit)) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Survey) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>  sc <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Probability of presence&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="aquatic-plants_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Isn’t that cool?</p>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>In this module, we’ve walked through the process of data read,
manipulation of a standard point-intercept data format, and examined
multiple ways to analyze and visualize species richness and individual
species presence-absence data. This should give you an appreciation for
the power and diversity at your disposal in R. And, this is really just
scratching the surface of the tools that are available to address these
needs in R. And, hopefully, you have the confidence to start exploring
more of those tools having been oriented to some of them!</p>
</div>

<!DOCTYPE html>

<br>

<hr>

<p style="color:gray; text-align:center">This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/legalcode">Creative Commons Attribution 4.0 International License</a>. Data are provided for educational purposes only unless otherwise noted.</p>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
